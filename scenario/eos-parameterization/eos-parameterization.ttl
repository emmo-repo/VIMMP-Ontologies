
##############################################
##                                          ##
##  EXAMPLE: PHOSGENE EOS PARAMETERIZATION  ##
##  BY NVT ENSEMBLE MONTE CARLO SIMULATION  ##
##                                          ##
##       LAST UPDATED: 27TH JUNE 2020       ##
##                                          ##
##############################################

<https://purl.vimmp.eu/semantics/scenario/eos-parameterization/eos-parameterization.ttl> a owl:Ontology.

@prefix scenario-eosmd: <https://purl.vimmp.eu/semantics/scenario/eos-parameterization/eos-parameterization.ttl#>.


################################
# IMPORTED EXTERNAL ONTOLOGIES #
################################

@prefix qudt: <http://qudt.org/schema/qudt#>.
@prefix xs: <http://www.w3.org/2001/XMLSchema#>.


#############################
# IMPORTED VIMMP ONTOLOGIES #
#############################

@prefix osmo: <https://purl.vimmp.eu/semantics/osmo/osmo.ttl#>.
@prefix otras: <https://purl.vimmp.eu/semantics/otras/otras.ttl#>.


##############################
# CONSIDERED FLUID: PHOSGENE #
##############################

scenario-eosmd:PHOSGENE a osmo:cas_listed_material, osmo:einecs_listed_material;
   osmo:has_cas_number "75-44-5"^^xs:string;
   osmo:has_ec_number "200-870-3"^^xs:string.


###########################
# DECLARATION OF SECTIONS #
###########################

# use case 1: thermodynamic properties of phosgene
#
scenario-eosmd:U1 a osmo:use_case;
   osmo:has_section_label "U_1"^^xs:string.

# materials model 1: intermolecular pair potential for phosgene
#
scenario-eosmd:M1 a osmo:materials_model;
   osmo:has_section_label "M_1"^^xs:string;
   osmo:has_model_granularity [
      osmo:has_aspect_annotation_content osmo:MESOSCOPIC
   ].

# materials model 2: phenomenological equation of state
#
scenario-eosmd:M2 a osmo:materials_model;
   osmo:has_section_label "M_2"^^xs:string;
   osmo:has_model_granularity [
      osmo:has_aspect_annotation_content osmo:CONTINUUM
   ].

# solver 1: ms2 canonical MC simulation
#
scenario-eosmd:S1 a osmo:solver;
   osmo:has_section_label "S_1"^^xs:string.

# solver 2: EOS fitter (part which solves the EOS)
#
scenario-eosmd:S2 a osmo:solver;
   osmo:has_section_label "S_2"^^xs:string.

# processor 1 (data): specify set of (T, rho) pairs for subsequent iteration
#
scenario-eosmd:P1 a osmo:data_processor;
   osmo:has_section_label "P_1"^^xs:string.

# processor 2 (preprocessor): input creation to a ms2 run & ms2 initialization
#
scenario-eosmd:P2 a osmo:preprocessor;
   osmo:has_section_label "P_2"^^xs:string.

# processor 3 (coupled): extraction of Massieu-Planck quantities during an ms2 run
#
scenario-eosmd:P3 a osmo:coupled_processor;
   osmo:has_section_label "P_3"^^xs:string.

# processor 4 (data): homogeneous (single-phase) state selection
#
scenario-eosmd:P4 a osmo:data_processor;
   osmo:has_section_label "P_4"^^xs:string.

# processor 5 (postprocessor): EOS fitter (part which reparameterizes the EOS)
#
scenario-eosmd:P5 a osmo:postprocessor;
   osmo:has_section_label "P_5"^^xs:string.


#####################
# LOGICAL RESOURCES #
#####################

# logical resource 1: VLE data from the EOS (or, initially, from available correlations for the real fluid)
#
scenario-eosmd:L1 a osmo:logical_resource;
   osmo:has_logical_label "L_1"^^xs:string;
   osmo:is_interactive "true"^^xs:boolean;  # user provides the initial input
   osmo:has_stored_variable scenario-eosmd:L1_CRITICAL_POINT, scenario-eosmd:L1_T_RHO_LIQ, scenario-eosmd:L1_T_RHO_VAP.

scenario-eosmd:L1_CRITICAL_POINT a osmo:unique_structure;
   osmo:has_variable_name "L1_critical_point";
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_Tc"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_rhoc"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ].
scenario-eosmd:L1_T_RHO_LIQ a osmo:structure_collection;
   osmo:has_variable_name "L1_T_rho_liq"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_T_value_liq"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_rho_liq"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ].
scenario-eosmd:L1_T_RHO_VAP a osmo:structure_collection;
   osmo:has_variable_name "L1_T_rho_vap"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_T_value_vap"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L1_rho_vap"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ].

# logical resource 2: temperature, density values for the MC simulations
#
scenario-eosmd:L2 a osmo:logical_resource;
   osmo:has_logical_label "L_2"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L2_T_RHO_PAIRS.

scenario-eosmd:L2_T_RHO_PAIRS a osmo:structure_collection;
   osmo:has_variable_name "L2_T_rho_pairs"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L2_T"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L2_rho"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ].

# logical resource 3: NVT boundary conditions and initial coordinates
#
scenario-eosmd:L3 a osmo:logical_resource;
   osmo:has_logical_label "L_3"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L3_BOUNDARY_CONDITIONS, scenario-eosmd:L3_INITIAL_CONFIGURATION.

scenario-eosmd:L3_BOUNDARY_CONDITIONS a osmo:unique_structure;
   osmo:has_variable_name "L3_NVT"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L3_N"^^xs:string;
      osmo:has_variable_unit [a qudt:CountingUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L3_V"^^xs:string;
      osmo:has_variable_unit [a qudt:VolumeUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L3_T"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ].
scenario-eosmd:L3_INITIAL_CONFIGURATION a osmo:logical_array;
   osmo:has_variable_name "L3_q_0"^^xs:string;
   osmo:has_dynamic_array_size [osmo:has_variable_name "L3_N"^^xs:string];
   osmo:has_index_name "L3_i"^^xs:string;  # index of the interaction site
   osmo:has_generic_element [
      a osmo:logical_array;
      osmo:has_variable_name "L3_qi_0"^^xs:string;
      osmo:has_index_name "L3_d"^^xs:string;
      osmo:has_static_array_size 3;
      osmo:has_generic_element [osmo:has_variable_name "L3_qid_0"^^xs:string];
      osmo:has_element_unit [a qudt:LengthUnit]
   ].

# logical resource 4: configurations accumulated during an MC simulation run
#
scenario-eosmd:L4 a osmo:logical_resource;
   osmo:has_logical_label "L_4"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L4_CONFIGURATIONS, scenario-eosmd:L3_BOUNDARY_CONDITIONS.

scenario-eosmd:L4_CONFIGURATIONS a osmo:logical_array;
   osmo:has_variable_name "L4_configurations_acc"^^xs:string;
   osmo:has_dynamic_array_size [osmo:has_variable_name "L4_n_config"^^xs:string];
   osmo:has_index_name "L4_k"^^xs:string;  # index of the configuration
   osmo:has_generic_element [
      a osmo:logical_array;
      osmo:has_variable_name "L4_q_k"^^xs:string;
      osmo:has_dynamic_array_size [osmo:has_variable_name "L3_N"^^xs:string];
      osmo:has_index_name "L4_i"^^xs:string;  # index of the interaction site
      osmo:has_generic_element [
         a osmo:logical_array;
         osmo:has_variable_name "L4_qi_k"^^xs:string;
         osmo:has_index_name "L4_d"^^xs:string;
         osmo:has_static_array_size 3;
         osmo:has_generic_element [osmo:has_variable_name "L4_qid_k"^^xs:string];
         osmo:has_element_unit [a qudt:LengthUnit]
      ]
   ].

# logical resource 5: Massieu potential derivatives (averaged) for all temperature, density pairs
#
scenario-eosmd:L5 a osmo:logical_resource;
   osmo:has_logical_label "L_5"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC.

scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC a osmo:structure_collection;
   osmo:has_variable_name "L5_Massieu_derivatives_MC"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L5_T"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L5_rho"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L5_mu"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarEnergyUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L5_p"^^xs:string;
      osmo:has_variable_unit [a qudt:PressureUnit]
   ], [
      a osmo:structure_collection;
      osmo:has_variable_name "L5_massieu_values"^^xs:string;
      osmo:has_structure_element [
         a osmo:unique_elementary;
         osmo:has_variable_name "L5_index_m"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L5_index_n"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L5_Phi_m_n"^^xs:string  # unit depends on m and n
      ]
   ].

# logical resource 6: Single-phase states and their Massieu potential derivative values from molecular simulation
#
scenario-eosmd:L6 a osmo:logical_resource;
   osmo:has_logical_label "L_6"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED.

scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED a osmo:structure_collection;
   osmo:has_variable_name "L6_T_rho_Massieu_MC_selected"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L6_T"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L6_rho"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ], [
      a osmo:structure_collection;
      osmo:has_variable_name "L6_massieu_values"^^xs:string;
      osmo:has_structure_element [
         a osmo:unique_elementary;
         osmo:has_variable_name "L6_index_m"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L6_index_n"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L6_Phi_m_n"^^xs:string  # unit depends on m and n
      ]
   ].

# logical resource 7: Massieu derivative values obtained from the EOS, depending on the EOS parameterization
#
scenario-eosmd:L7 a osmo:logical_resource;
   osmo:has_logical_label "L_7"^^xs:string;
   osmo:is_interactive "false"^^xs:boolean;
   osmo:has_stored_variable scenario-eosmd:L7_EOS_AND_MASSIEU.

scenario-eosmd:L7_EOS_AND_MASSIEU a osmo:structure_collection;
   osmo:has_variable_name "L7_eos_and_massieu"^^xs:string;
   osmo:has_structure_element scenario-eosmd:L7_EOS_PARAMETERIZATION, scenario-eosmd:L7_MASSIEU_DERIVATIVES.

scenario-eosmd:L7_EOS_PARAMETERIZATION a osmo:unique_structure;
   osmo:has_variable_name "L7_EOS_parameterization"^^xs:string;
   osmo:has_structure_element [
      a osmo:logical_array;
      osmo:has_variable_name "L7_ideal"^^xs:string;
      osmo:has_index_name "L7_k_id"^^xs:string;
      osmo:has_static_array_size 3;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L7_param_k_id"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_u_k_id"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_v_k_id"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ]
      ]
   ], [
      a osmo:logical_array;
      osmo:has_variable_name "L7_residual_polynomial"^^xs:string;
      osmo:has_index_name "L7_k_res_poly"^^xs:string;
      osmo:has_static_array_size 22;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L7_param_k_res_poly"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_n_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_t_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_d_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ]
      ]
   ], [
      a osmo:logical_array;
      osmo:has_variable_name "L7_residual_exponential"^^xs:string;
      osmo:has_index_name "L7_k_res_exp"^^xs:string;
      osmo:has_static_array_size 18;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L7_param_k_res_exp"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_n_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_t_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_d_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L7_l_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ]
      ]
   ].

scenario-eosmd:L7_MASSIEU_DERIVATIVES a osmo:structure_collection;
   osmo:has_variable_name "L7_Massieu_from_EOS"^^xs:string;
   osmo:has_structure_element [
      a osmo:unique_elementary;
      osmo:has_variable_name "L7_T"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L7_rho"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ], [
      a osmo:structure_collection;
      osmo:has_variable_name "L7_massieu_values"^^xs:string;
      osmo:has_structure_element [
         a osmo:unique_elementary;
         osmo:has_variable_name "L7_index_m"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L7_index_n"^^xs:string;
         osmo:has_variable_unit [a qudt:CountingUnit]
      ], [
         a osmo:unique_elementary;
         osmo:has_variable_name "L7_Phi_m_n"^^xs:string  # unit depends on m and n
      ]
   ].

# logical resource 8: EOS parameters
#
scenario-eosmd:L8 a osmo:logical_resource;
   osmo:has_logical_label "L_8"^^xs:string;
   osmo:is_interactive "true"^^xs:boolean;  # user provides the initial input
   osmo:has_stored_variable scenario-eosmd:L8_EOS_PARAMETERIZATION.

scenario-eosmd:L8_EOS_PARAMETERIZATION a osmo:unique_structure;
   osmo:has_variable_name "L8_EOS_parameterization"^^xs:string;
   osmo:has_structure_element [
      a osmo:logical_array;
      osmo:has_variable_name "L8_ideal"^^xs:string;
      osmo:has_index_name "L8_k_id"^^xs:string;
      osmo:has_static_array_size 3;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L8_param_k_id"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_u_k_id"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_v_k_id"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ]
      ]
   ], [
      a osmo:logical_array;
      osmo:has_variable_name "L8_residual_polynomial"^^xs:string;
      osmo:has_index_name "L8_k_res_poly"^^xs:string;
      osmo:has_static_array_size 22;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L8_param_k_res_poly"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_n_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_t_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_d_k_res_poly"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ]
      ]
   ], [
      a osmo:logical_array;
      osmo:has_variable_name "L8_residual_exponential"^^xs:string;
      osmo:has_index_name "L8_k_res_exp"^^xs:string;
      osmo:has_static_array_size 18;
      osmo:has_generic_element [
         a osmo:unique_structure;
         osmo:has_variable_name "L8_param_k_res_exp"^^xs:string;
         osmo:has_structure_element [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_n_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:DimensionlessUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_t_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_d_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ], [
            a osmo:unique_elementary;
            osmo:has_variable_name "L8_l_k_res_exp"^^xs:string;
            osmo:has_variable_unit [a qudt:CountingUnit]
         ]
      ]
   ], [
      a osmo:unique_elementary;
      osmo:has_variable_name "L8_is_final_converged_outcome";
      osmo:has_variable_unit [a qudt:CountingUnit]  # e.g., integer with 1 for true, 0 for false
   ].


########################################
# SUB-WORKFLOW C1 & V1: MS2 SIMULATION #
########################################

scenario-eosmd:V1 a osmo:indexed_graph;
   osmo:has_resource_label "V_1"^^xs:string;
   osmo:has_coupled_instances "false"^^xs:boolean;
   osmo:has_linked_instances "false"^^xs:boolean;
   osmo:has_index scenario-eosmd:L2_T_RHO_PAIRS;
   osmo:is_direct_effect_of scenario-eosmd:P1_NODE;
   osmo:has_subgraph scenario-eosmd:C1.

scenario-eosmd:C1 a osmo:concrete_graph;
   osmo:has_resource_label "C_1"^^xs:string;
   osmo:instantiates scenario-eosmd:V1;
   osmo:has_starting_point scenario-eosmd:P2_NODE;
   osmo:has_terminal_point scenario-eosmd:P3_NODE;
   osmo:considers_model scenario-eosmd:M1;
   osmo:contains_section scenario-eosmd:S1, scenario-eosmd:P2, scenario-eosmd:P3;
   osmo:contains_logical scenario-eosmd:L3, scenario-eosmd:L4;
   osmo:contains_graph scenario-eosmd:S1_NODE, scenario-eosmd:P2_NODE, scenario-eosmd:P3_NODE.

scenario-eosmd:S1_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:S1;
   osmo:is_direct_effect_of scenario-eosmd:P2_NODE;
   osmo:is_coupled_with scenario-eosmd:P3_NODE.
scenario-eosmd:P2_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:P2.
scenario-eosmd:P3_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:P3;
   osmo:is_coupled_with scenario-eosmd:S1_NODE.

scenario-eosmd:L2_TO_P2 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L2;
   osmo:has_access_point scenario-eosmd:P2;
   osmo:has_carried_variable scenario-eosmd:L2_T_RHO_PAIRS.
scenario-eosmd:P2_TO_L3 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_access_point scenario-eosmd:P2;
   osmo:has_resource scenario-eosmd:L3;
   osmo:has_carried_variable scenario-eosmd:L3_BOUNDARY_CONDITIONS, scenario-eosmd:L3_INITIAL_CONFIGURATION.
scenario-eosmd:L3_TO_S1 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L3;
   osmo:has_access_point scenario-eosmd:S1;
   osmo:has_carried_variable scenario-eosmd:L3_BOUNDARY_CONDITIONS, scenario-eosmd:L3_INITIAL_CONFIGURATION.
scenario-eosmd:S1_TO_L4 a osmo:logical_write_access;
   osmo:is_at_runtime "true"^^xs:boolean;
   osmo:is_final "false"^^xs:boolean;
   osmo:has_access_point scenario-eosmd:S1;
   osmo:has_resource scenario-eosmd:L4;
   osmo:has_carried_variable scenario-eosmd:L4_CONFIGURATIONS, scenario-eosmd:L3_BOUNDARY_CONDITIONS.
scenario-eosmd:L4_TO_P3 a osmo:logical_read_access;
   osmo:is_at_runtime "true"^^xs:boolean;
   osmo:is_initial "false"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L4;
   osmo:has_access_point scenario-eosmd:P3;
   osmo:has_carried_variable scenario-eosmd:L4_CONFIGURATIONS, scenario-eosmd:L3_BOUNDARY_CONDITIONS.
scenario-eosmd:P3_TO_L5 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_access_point scenario-eosmd:P3;
   osmo:has_resource scenario-eosmd:L5;
   osmo:has_carried_variable scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC.


############################################################
# SUB-WORKFLOW C2 & V2: EQUATION OF STATE PARAMETERIZATION #
############################################################

scenario-eosmd:V2 a osmo:indexed_graph;
   osmo:has_resource_label "V_2"^^xs:string;
   osmo:has_coupled_instances "false"^^xs:boolean;
   osmo:has_linked_instances "true"^^xs:boolean;  # loop
   osmo:has_index scenario-eosmd:V2_LOOP_INDEX;
   osmo:is_direct_effect_of scenario-eosmd:P4_NODE;
   osmo:has_subgraph scenario-eosmd:C2.
scenario-eosmd:C2 a osmo:concrete_graph;
   osmo:has_resource_label "C_2"^^xs:string;
   osmo:instantiates scenario-eosmd:V2;
   osmo:has_starting_point scenario-eosmd:S2_NODE;
   osmo:has_terminal_point scenario-eosmd:S2_NODE;  # loop
   osmo:considers_model scenario-eosmd:M2;
   osmo:contains_section scenario-eosmd:S2, scenario-eosmd:P5;
   osmo:contains_logical scenario-eosmd:L7;
   osmo:contains_graph scenario-eosmd:S2_NODE, scenario-eosmd:P5_NODE.
scenario-eosmd:V2_LOOP_INDEX a osmo:elementary_collection;
   osmo:has_variable_name "V2_loop_index"^^xs:string;
   osmo:has_variable_unit [a qudt:CountingUnit].

scenario-eosmd:S2_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:S2;
   osmo:is_direct_effect_of scenario-eosmd:P5_NODE.
scenario-eosmd:P5_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:P5;
   osmo:is_direct_effect_of scenario-eosmd:S2_NODE.

scenario-eosmd:L6_TO_S2 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L6;
   osmo:has_access_point scenario-eosmd:S2;
   osmo:has_carried_variable scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED.
scenario-eosmd:S2_TO_L1 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L1;
   osmo:has_access_point scenario-eosmd:S2;
   osmo:has_carried_variable scenario-eosmd:L1_CRITICAL_POINT, scenario-eosmd:L1_T_RHO_LIQ, scenario-eosmd:L1_T_RHO_VAP.
scenario-eosmd:S2_TO_L7 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L7;
   osmo:has_access_point scenario-eosmd:S2;
   osmo:has_carried_variable scenario-eosmd:L7_EOS_AND_MASSIEU.
scenario-eosmd:L7_TO_P5 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L7;
   osmo:has_access_point scenario-eosmd:P5;
   osmo:has_carried_variable scenario-eosmd:L7_EOS_AND_MASSIEU.
scenario-eosmd:L6_TO_P5 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L6;
   osmo:has_access_point scenario-eosmd:P5;
   osmo:has_carried_variable scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED.
scenario-eosmd:P5_TO_L8 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L8;
   osmo:has_access_point scenario-eosmd:P5;
   osmo:has_carried_variable scenario-eosmd:L8_EOS_PARAMETERIZATION.


#################################
# SIMULATION WORKFLOW MAIN LOOP #
#################################

scenario-eosmd:V3 a osmo:indexed_graph;
   osmo:has_resource_label "V_3"^^xs:string;
   osmo:has_coupled_instances "false"^^xs:boolean;
   osmo:has_linked_instances "true"^^xs:boolean;  # loop
   osmo:has_index scenario-eosmd:V3_LOOP_INDEX;
   osmo:has_subgraph scenario-eosmd:C3.
scenario-eosmd:C3 a osmo:concrete_graph;
   osmo:has_resource_label "C_3"^^xs:string;
   osmo:instantiates scenario-eosmd:V3;
   osmo:has_starting_point scenario-eosmd:P1_NODE;
   osmo:has_terminal_point scenario-eosmd:P1_NODE;  # loop
   osmo:contains_section scenario-eosmd:M2, scenario-eosmd:P1, scenario-eosmd:P4;
   osmo:contains_logical scenario-eosmd:L1, scenario-eosmd:L2, scenario-eosmd:L5, scenario-eosmd:L6, scenario-eosmd:L8;
   osmo:contains_graph scenario-eosmd:P1_NODE, scenario-eosmd:P4_NODE, scenario-eosmd:L8_NODE, scenario-eosmd:V1, scenario-eosmd:V2.
scenario-eosmd:V2_LOOP_INDEX a osmo:elementary_collection;
   osmo:has_variable_name "V2_loop_index"^^xs:string;
   osmo:has_variable_unit [a qudt:CountingUnit].

scenario-eosmd:M2 osmo:applies_to scenario-eosmd:C2.

scenario-eosmd:P1_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:P1;
   osmo:is_direct_effect_of scenario-eosmd:V2.
scenario-eosmd:P4_NODE a osmo:workflow_node;
   osmo:contains_section scenario-eosmd:P4;
   osmo:is_direct_effect_of scenario-eosmd:V1.
scenario-eosmd:L8_NODE a osmo:logical_node;
   osmo:contains_logical scenario-eosmd:L8.

scenario-eosmd:L1_TO_P1 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L1;
   osmo:has_access_point scenario-eosmd:P1;
   osmo:has_carried_variable scenario-eosmd:L1_CRITICAL_POINT, scenario-eosmd:L1_T_RHO_LIQ, scenario-eosmd:L1_T_RHO_VAP.
scenario-eosmd:P1_TO_L2 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L2;
   osmo:has_access_point scenario-eosmd:P1;
   osmo:has_carried_variable scenario-eosmd:L2_T_RHO_PAIRS.
scenario-eosmd:L5_TO_P4 a osmo:logical_read_access;
   osmo:is_initial "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L5;
   osmo:has_access_point scenario-eosmd:P4;
   osmo:has_carried_variable scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC.
scenario-eosmd:P4_TO_L6 a osmo:logical_write_access;
   osmo:is_final "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L6;
   osmo:has_access_point scenario-eosmd:P4;
   osmo:has_carried_variable scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED.
scenario-eosmd:L8_TO_M2 a osmo:logical_read_access;
   osmo:is_parameterization "true"^^xs:boolean;
   osmo:has_resource scenario-eosmd:L8;
   osmo:has_access_point scenario-eosmd:M2;
   osmo:has_carried_variable scenario-eosmd:L8_EOS_PARAMETERIZATION.


###############################
# OVERALL SIMULATION WORKFLOW #
###############################

scenario-eosmd:W a osmo:simulation_workflow;
   osmo:is_concrete "true"^^xs:boolean;
   osmo:has_resource_label "W"^^xs:string;
   osmo:has_starting_point scenario-eosmd:V3_NODE;
   osmo:has_terminal_point scenario-eosmd:V3_NODE;  # V3 is the only element of the workflow execution
   osmo:has_simulation_outcome scenario-eosmd:L8_NODE;
   osmo:contains_section scenario-eosmd:U1, scenario-eosmd:M1;
   osmo:contains_graph scenario-eosmd:V3_NODE, scenario-eosmd:V3.

scenario-eosmd:U1 osmo:applies_to scenario-eosmd:W.
scenario-eosmd:M1 osmo:applies_to scenario-eosmd:C1.

scenario-eosmd:V3_NODE a osmo:workflow_node;
   osmo:contains_graph scenario-eosmd:V3.


########################
# SECTION DESCRIPTIONS #
########################

scenario-eosmd:U1
   osmo:has_use_case_description [
      osmo:has_aspect_text_content "thermodynamic properties of phosgene"^^xs:string
   ];
   osmo:has_use_case_material [
      osmo:has_aspect_paradigmatic_content scenario-eosmd:PHOSGENE
   ];
   osmo:has_use_case_boundary_condition [
      osmo:has_aspect_text_content "this use case aims at obtaining a quantitatively accurate empirical fundamental equation of state by which the thermodynamic properties of fluid phosgene can be predicted over a wide range of thermodynamic conditions"^^xs:string
   ];
   osmo:has_use_case_literature [
      osmo:has_aspect_paradigmatic_content scenario-eosmd:RUTKAI_VRABEC_2015
   ].

scenario-eosmd:M1
   osmo:has_model_type [
      osmo:has_aspect_annotation_content [
         a osmo:pe_type_mesoscopic_partition_function;
         osmo:has_pe_type_descriptor "M.4"^^xs:string
      ];
      osmo:has_aspect_text_content "MC simulation with a molecular model"^^xs:string
   ];
   osmo:has_model_granularity [
      osmo:has_aspect_annotation_content osmo:MESOSCOPIC
   ];
   osmo:has_model_boundary_condition [
      osmo:has_aspect_object_content scenario-eosmd:ISOTHERMAL_ISOCHORIC;
      osmo:has_aspect_text_content "the molecular model properties are evaluated at given density (or molar volume) and temperature"^^xs:string
   ];
   osmo:has_section_literature [
      osmo:has_aspect_paradigmatic_content scenario-eosmd:HUANG_ET_AL_2011
   ].
scenario-eosmd:M2
   osmo:has_model_type [
      osmo:has_aspect_annotation_content [
         a osmo:pe_type_continuum_thermodynamics;
         osmo:has_pe_type_descriptor "CO.5"^^xs:string
      ];
      osmo:has_aspect_text_content "empirical fundamental equation of state"^^xs:string
   ];
   osmo:has_model_granularity [
      osmo:has_aspect_annotation_content osmo:CONTINUUM
   ];
   osmo:has_model_boundary_condition [
      osmo:has_aspect_object_content scenario-eosmd:ISOTHERMAL_ISOCHORIC;
      osmo:has_aspect_text_content "the equation of state is evaluated at given density (or molar volume) and temperature"^^xs:string
   ], [
      osmo:has_aspect_object_content scenario-eosmd:ISOTHERMAL_VLE;
      osmo:has_aspect_text_content "the equation of state is applied to the vapour-liquid equilibrium at a given temperature"^^xs:string
   ];
   osmo:has_section_literature [
      osmo:has_aspect_paradigmatic_content scenario-eosmd:RUTKAI_VRABEC_2015
   ].

scenario-eosmd:ISOTHERMAL_ISOCHORIC a osmo:quantitative_condition;
   osmo:contains_precomputed_variable [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M1_M2_given_density"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarConcentrationUnit]
   ], [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M1_M2_given_temperature"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ].
scenario-eosmd:ISOTHERMAL_VLE a osmo:quantitative_condition;
   osmo:contains_precomputed_variable [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M2_given_temperature"^^xs:string;
      osmo:has_variable_unit [a qudt:TemperatureUnit]
   ];
   osmo:contains_runtime_variable [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M2_p_liq"^^xs:string;
      osmo:has_variable_unit [a qudt:PressureUnit]
   ], [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M2_p_vap"^^xs:string;
      osmo:has_variable_unit [a qudt:PressureUnit]
   ], [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M2_mu_liq"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarEnergyUnit]
   ], [
      a osmo:physical_variable, osmo:elementary_logical;
      osmo:has_variable_name "M2_mu_vap"^^xs:string;
      osmo:has_variable_unit [a qudt:MolarEnergyUnit]
   ].

scenario-eosmd:S1
   osmo:has_logical_input scenario-eosmd:L3_BOUNDARY_CONDITIONS, scenario-eosmd:L3_INITIAL_CONFIGURATION;
   osmo:has_logical_output scenario-eosmd:L4_CONFIGURATIONS, scenario-eosmd:L3_BOUNDARY_CONDITIONS;
   osmo:has_section_literature [
      osmo:has_aspect_paradigmatic_content scenario-eosmd:RUTKAI_ET_AL_2017
   ].
scenario-eosmd:S2
   osmo:has_logical_input scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED;
   osmo:has_logical_output scenario-eosmd:L7_EOS_AND_MASSIEU, scenario-eosmd:L1_CRITICAL_POINT, scenario-eosmd:L1_T_RHO_LIQ, scenario-eosmd:L1_T_RHO_VAP.

scenario-eosmd:P1
   osmo:has_logical_input scenario-eosmd:L1_CRITICAL_POINT, scenario-eosmd:L1_T_RHO_LIQ, scenario-eosmd:L1_T_RHO_VAP;
   osmo:has_logical_output scenario-eosmd:L2_T_RHO_PAIRS.
scenario-eosmd:P2
   osmo:has_logical_input scenario-eosmd:L2_T_RHO_PAIRS;
   osmo:has_logical_output scenario-eosmd:L3_BOUNDARY_CONDITIONS, scenario-eosmd:L3_INITIAL_CONFIGURATION.
scenario-eosmd:P3
   osmo:has_logical_input scenario-eosmd:L4_CONFIGURATIONS, scenario-eosmd:L3_BOUNDARY_CONDITIONS;
   osmo:has_logical_output scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC.
scenario-eosmd:P4
   osmo:has_logical_input scenario-eosmd:L5_MASSIEU_DERIVATIVES_MC;
   osmo:has_logical_output scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED.
scenario-eosmd:P5
   osmo:has_logical_input scenario-eosmd:L6_T_RHO_MASSIEU_MC_SELECTED, scenario-eosmd:L7_EOS_AND_MASSIEU;
   osmo:has_logical_output scenario-eosmd:L8_EOS_PARAMETERIZATION.


#####################################
# LITERATURE REFERENCES (VIA OTRAS) #
#####################################

# paper containing the employed molecular model of phosgene
#
scenario-eosmd:HUANG_ET_AL_2011 a otras:citation;
   otras:has_first_author_surname "Huang"^^xs:string;
   otras:has_publication_year 2011;
   otras:has_author_map [
      otras:has_author_map_element [
         otras:has_ame_index 1;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "Y.-L."^^xs:string;
            otras:has_identified_surname "Huang"^^xs:string
         ]
      ], [
         otras:has_ame_index 2;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "M."^^xs:string;
            otras:has_identified_surname "Heilig"^^xs:string
         ]
      ], [
         otras:has_ame_index 3;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "H."^^xs:string;
            otras:has_identified_surname "Hasse"^^xs:string
         ]
      ], [
         otras:has_ame_index 4;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "J."^^xs:string;
            otras:has_identified_surname "Vrabec"^^xs:string
         ]
      ]
   ];
   otras:has_publication_title "Vapor–liquid equilibria of hydrogen chloride, phosgene, benzene, chlorobenzene, ortho‐dichlorobenzene, and toluene by molecular simulation"^^xs:string;
   otras:has_publication_journal_name "AIChE Journal"^^xs:string;
   otras:has_publication_journal_abbreviation "AIChE J."^^xs:string;
   otras:has_publication_journal_issn "1547-5905"^^xs:string;
   otras:has_publication_journal_volume 57;
   otras:has_publication_journal_issue 4;
   otras:has_publication_journal_pages "1043-1060"^^xs:string;
   otras:has_doi "10.1002/aic.12329"^^xs:string;
   otras:is_about scenario-eosmd:PHOSGENE.

# paper on ms2 release 3
#
scenario-eosmd:RUTKAI_ET_AL_2017 a otras:citation;
   otras:has_first_author_surname "Rutkai"^^xs:string;
   otras:has_publication_year 2017;
   otras:has_author_map [
      otras:has_author_map_element [
         otras:has_ame_index 1;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "G."^^xs:string;
            otras:has_identified_surname "Rutkai"^^xs:string
         ]
      ], [
         otras:has_ame_index 2;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "A."^^xs:string;
            otras:has_identified_surname "Köster"^^xs:string
         ]
      ], [
         otras:has_ame_index 3;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "G."^^xs:string;
            otras:has_identified_surname "Guevara Carrión"^^xs:string
         ]
      ], [
         otras:has_ame_index 4;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "T."^^xs:string;
            otras:has_identified_surname "Janzen"^^xs:string
         ]
      ], [
         otras:has_ame_index 5;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "M."^^xs:string;
            otras:has_identified_surname "Schappals"^^xs:string
         ]
      ], [
         otras:has_ame_index 6;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "C. W."^^xs:string;
            otras:has_identified_surname "Glass"^^xs:string
         ]
      ], [
         otras:has_ame_index 7;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "M."^^xs:string;
            otras:has_identified_surname "Bernreuther"^^xs:string
         ]
      ], [
         otras:has_ame_index 8;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "A."^^xs:string;
            otras:has_identified_surname "Wafai"^^xs:string
         ]
      ], [
         otras:has_ame_index 9;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "S."^^xs:string;
            otras:has_identified_surname "Stephan"^^xs:string
         ]
      ], [
         otras:has_ame_index 10;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "M."^^xs:string;
            otras:has_identified_surname "Kohns"^^xs:string
         ]
      ], [
         otras:has_ame_index 11;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "S."^^xs:string;
            otras:has_identified_surname "Reiser"^^xs:string
         ]
      ], [
         otras:has_ame_index 12;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "S."^^xs:string;
            otras:has_identified_surname "Deublein"^^xs:string
         ]
      ], [
         otras:has_ame_index 13;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "M."^^xs:string;
            otras:has_identified_surname "Horsch"^^xs:string
         ]
      ], [
         otras:has_ame_index 14;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "H."^^xs:string;
            otras:has_identified_surname "Hasse"^^xs:string
         ]
      ], [
         otras:has_ame_index 15;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "J."^^xs:string;
            otras:has_identified_surname "Vrabec"^^xs:string
         ]
      ]
   ];
   otras:has_publication_title "ms2: A molecular simulation tool for thermodynamic properties, release 3.0"^^xs:string;
   otras:has_publication_journal_name "Computer Physics Communications"^^xs:string;
   otras:has_publication_journal_abbreviation "Comp. Phys. Comm."^^xs:string;
   otras:has_publication_journal_issn "0010-4655"^^xs:string;
   otras:has_publication_journal_volume 221;
   otras:has_publication_journal_pages "343-351"^^xs:string;
   otras:has_doi "10.1016/j.cpc.2017.07.025"^^xs:string.

# paper on phosgene EOS fitting my molecular simulation
#
scenario-eosmd:RUTKAI_VRABEC_2015 a otras:citation;
   otras:has_first_author_surname "Rutkai"^^xs:string;
   otras:has_publication_year 2015;
   otras:has_author_map [
      otras:has_author_map_element [
         otras:has_ame_index 1;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "G."^^xs:string;
            otras:has_identified_surname "Rutkai"^^xs:string
         ]
      ], [
         otras:has_ame_index 2;
         otras:has_ame_identifier [
            otras:has_identified_given_name_initials "J."^^xs:string;
            otras:has_identified_surname "Vrabec"^^xs:string
         ]
      ]
   ];
   otras:has_publication_title "Empirical fundamental equation of state for phosgene based on molecular simulation data"^^xs:string;
   otras:has_publication_journal_name "Journal of Chemical & Engineering Data"^^xs:string;
   otras:has_publication_journal_abbreviation "J. Chem. Eng. Data"^^xs:string;
   otras:has_publication_journal_issn "0021-9568"^^xs:string;
   otras:has_publication_journal_volume 60;
   otras:has_publication_journal_issue 10;
   otras:has_publication_journal_pages "2895-2905"^^xs:string;
   otras:has_doi "10.1021/acs.jced.5b00266"^^xs:string;
   otras:is_about scenario-eosmd:PHOSGENE.
